syntax = "proto3";

package search;
option go_package = "socialnet/services/search/gen;searchpb";

import "google/api/annotations.proto";
import "user.proto";
import "post.proto";

service SearchService {
  // üîç –ü–æ–∏—Å–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
  rpc SearchUsers(SearchRequest) returns (SearchUsersResponse) {
    option (google.api.http) = {
      get: "/api/v1/search/users"
    };
  }

  // üîç –ü–æ–∏—Å–∫ –ø–æ—Å—Ç–æ–≤
  rpc SearchPosts(SearchRequest) returns (SearchPostsResponse) {
    option (google.api.http) = {
      get: "/api/v1/search/posts"
    };
  }

  // üîç –£–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã–π –ø–æ–∏—Å–∫ –ø–æ –≤—Å–µ–º (—é–∑–µ—Ä—ã + –ø–æ—Å—Ç—ã)
  rpc SearchAll(SearchRequest) returns (SearchAllResponse) {
    option (google.api.http) = {
      get: "/api/v1/search"
    };
  }
}

// ---- Requests ----
message SearchRequest {
  string query = 1;   // –ø–æ–∏—Å–∫–æ–≤–∞—è —Å—Ç—Ä–æ–∫–∞
  int32 limit = 2;    // –ª–∏–º–∏—Ç –Ω–∞ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
}

// ---- Responses ----
message SearchUsersResponse {
  repeated user.User users = 1;
}

message SearchPostsResponse {
  repeated post.Post posts = 1;
}

message SearchAllResponse {
  repeated user.User users = 1;
  repeated post.Post posts = 2;
}
